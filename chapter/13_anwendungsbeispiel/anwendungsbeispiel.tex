\chapter{Versuchsaufbau}

\section{Einleitung}

Um die vom Team erstellte Plattform auch unter realen Bedingungen testen zu können, wurde ein Versuchsaufbau mit zwei Drohnen erstellt, die es ermöglichen Produkte zu transportieren und über dem Kunden mit einem Fallschirm abzuwerfen. Der Aufbau der Drohnen beinhaltete die Zusammenstellung der passenden Komponenten, den Zusammenbau der Drohnen und die Planung und Erstellung von zusätzlichen Halterungen für die obengenannten spezifischen Anforderungen.\\

Bei der Zusammenstellung der Komponenten haben wir vor allem auf die gute Verfügbarkeit von Ersatzteilen und einen hohen Marktanteil der Komponenten geachtet. Besonders wichtig erschien uns, dass ein Anbieter nicht an einen Hersteller gebunden ist, sondern die Drohne an seine Bedürfnisse (Zuladung, Reichweite, Geschwindigkeit) anpassen kann. Es sollten also möglichst wenige Vorraussetzungen bestehen um die Plattform nutzen zu können, folgende sind allerdings unabdingbar:

\begin{itemize}

\item Flight-Controller muss \Gls{MAVLink} Protokoll unterstüzen
\item Onboard-App muss über MAVLink mit dem Flight-Controller verbunden sein. (Über USB oder eine Funk-Telemetrieverbindung.)
\end{itemize}

\section{Multicopter Hardware}

\section{Teile-Liste}

\begin{tabularx}{\textwidth}{|X|l|l r|}
	\hline
	\textbf{Bezeichnung} & \textbf{Bezugsquelle} && \textbf{Preis}\\
	\hline \hline
	DJI F450 ARF Kit & conrad.ch & CHF &229.95 \\\hline
	DJI F450/F550 Landegestell & conrad.ch & CHF &24.95 \\\hline
	3DR Pixhawk & 3dr.com & USD& 199.99 \\\hline
	3DR uBlox GPS with Compass Kit & 3dr.com & USD &89.99 \\\hline
	3DR uBlox GPS with Compass Kit & 3dr.com & USD &89.99 \\\hline
	Pixhawk external LED and USB & 3dr.com & USD & 20.00 \\\hline
	FrSky X8+ Radio Transmitter & 3dr.com & USD & 89.99 \\\hline
	FrSky X8R Receiver & hebu-shop.ch & CHF & 39.95 \\\hline
	Delock Micro USB OTG Kabel & digitec.ch & CHF &15.90 \\\hline
	Multistar High Capacity 4S Akku & hobbyking.com & USD& 25.25 \\\hline
	Multistar High Capacity 4S Akku & hobbyking.com & USD &25.25 \\\hline
	APM Flight Controller Damping Platform & hobbyking.com & USD& 2.69 \\\hline
	Smartphone und GPS Halterung & eigener 3D-Print & CHF &27.50\\\hline
	Abwurfvorrichtung & eigener 3D-Print & CHF &25.50\\\hline
	Hitec Super Servo S-Bec (Stromversorgung Servo) & brack.ch & CHF &13.90\\\hline
	Tactic TSX10 (Servo für Abwurf) & brack.ch & CHF & 14.90\\\hline
	Total& & CHF/USD & $\approx 1000.00$\\\hline
\end{tabularx}


\subsection{Frame und Antrieb}

Der Frame, die Motoren und ESCs wurden als Kit gekauft. Es handelt sich dabei um ein DJI Flamewheel 450 Frame mit DJI 2312 960kV Motoren und ESeries 420 20A ESCs. Dieses Kit ist weltweit gut verfügbar und deshalb ideal geeignet um einen Versuchsaufbau zu erstellen.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth] {images/hardware/f450.jpg} 
\caption{DJI F450 Flamewheel Kit}
\label{fig:f450}
\end{figure}


\subsection{Flight-Controller}

Der Flight-Controller ist das Herzstück eines Quadcopters. Im Unterschied zu anderen ferngesteuerten Fahr- und Flugzeugen kann ein Multicopter nur über ein Fly-by-Wire System kontrolliert werden. Das heisst alle Befehle, die von der Fernbedienung gesendet werden, müssen interpretiert und umgewandelt werden, damit die Motoren eine Bewegung in die gewünschte Richtung erzeugen können. In Kombination mit einem GPS Modul (Abb. \ref{fig:gps-module}) ermöglich der Controller verschiedene Flugmodi, wie beispielsweise das Schweben an einem Punkt oder automatisches abfliegen von Wegpunkten.

Als Flight-Controller setzen wir ein Pixhawk ein. Es ist sehr vielseitig und kann gut mit zusätzlichen Sensoren erweitert werden, ausserdem unterstützt es gängige Firmwares, die auch auf günstigeren Controllern laufen. Als Firmware für das Pixhawk setzen wir ArduCopter ein, da sie komplett Open-Source ist und auch bei vielen anderen Projekten eingesetzt wird. Sie unterstützt ausserdem das \Gls{MAVLink} Protokoll, das es ermöglicht verschiedene Flight-Controller über verschiedene Protokolle und Anschlüsse anzusprechen.

\begin{figure}[h]
\centering
\includegraphics[width=0.3\textwidth] {images/hardware/pixhawk.jpg} 
\caption{Pixhawk Flight-Controller}
\label{fig:pixhawk}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.3\textwidth] {images/hardware/gps-module.jpg} 
\caption{GPS-Modul für Pixhawk}
\label{fig:gps-module}
\end{figure}

\subsection{Ausbaustufen}

Während des Projekts wurde die Hardware laufend den Bedürfnissen angepasst. Daher existieren mehrere Iterationen der Drohne, die für die Versuche genutzt wurden und geholfen haben Risiken früh auszuschliessen.

\subsubsection{Version 1}

\begin{figure}[H]
\centering
\includegraphics[width=0.4\textwidth] {images/hardware/prototype1.jpg}
\caption{Erster Prototyp ohne Landegestell und ohne Smartphone}
\label{fig:prototyp-1}
\end{figure}

Um das Zusammenspiel der Hardwarekomponenten zu testen und erste Erfahrungen mit dem GPS und den verschiedenen Flugmodi zu sammeln, wurde in der ersten Iteration nur die Drohne in einem minimal Flugzustand aufgebaut.

\subsubsection{Version 2}

\begin{figure}[H]
\centering
\includegraphics[width=0.4\textwidth] {images/hardware/prototype2.jpg}
\caption{Drohnen Aufbau mit Smartphone}
\label{fig:prototyp-2}
\end{figure}

Um die Risiken R08 (Ardupilot Handhabung) und R09 (Ardupilot API) frühzeitig auszuschliessen (siehe Tabelle \ref{table:risk-table}), wurde das Smartphone zusätzlich auf die Drohne montiert, und mit einem ersten Prototypen der Onboard-App getestet. \\
Nach dem Test wurde uns klar, dass eine Befestigung für das Smartphone erarbeitet werden mussten, um es sicher zu transportieren und bedienbar zu positionieren.

\begin{figure}[H]
	\centering
	\begin{minipage}[b]{0.4\textwidth}
		% TODO Ein Bild ohne Tastatur und Stuhl wäre auch gut?
		\includegraphics[width=\textwidth]{images/hardware/drone-with-handy.jpg}
	\caption{Modell der Handy Halterung}
	\label{fig:case-model}
	\end{minipage}
	\hfill
	\begin{minipage}[b]{0.4\textwidth}
		\includegraphics[width=\textwidth]{images/hardware/case-model.png}
	\caption{Drohne mit Handy Halterung}
	\label{fig:prototyp-3}
	\end{minipage}
\end{figure}

Es wurde eine Halterung konzipiert \ref{fig:case-model}, welche wir später im 3D-Druck Verfahren produzieren liessen.
Die Handy-Halterung konnte auch gleich genutzt werden, um den Pixhawk-Controller zu verstecken und das GPS Module gut exponiert zu montieren. 

\subsubsection{Version 3}
Nachdem mit der Drohne zahlreiche autonome Testflüge unternommen wurden, musste eine Möglichkeit erarbeitet werden, wie die Lieferung an den Kunden gebracht werden kann.

\begin{figure}[H]
	\centering
	\begin{minipage}[b]{0.4\textwidth}
		\includegraphics[width=\textwidth]{images/hardware/parachute-model.jpg}
		\caption{Halterung}
		\label{asdf}
	\end{minipage}
	\hfill
	\begin{minipage}[b]{0.4\textwidth}
		% TODO Hier muss ein bessers Bild her ( oder Kafferahmen weg photoshoppen )
		\includegraphics[width=\textwidth]{images/hardware/drone-with-servo.jpg}
		\caption{Drohne mit dem Abwurfsmechanismus}
		\label{asdf}
	\end{minipage}
\end{figure}


Es wurde ein einfacher Mechanismus mit einem handelsüblichen Modelbau-Servo konstruiert. Die Abbildung \ref{fig:AbwurfMechanismus} zeigt, wie der Servo den Stift entfernt und so die Ladung freigeben kann. \\
Das Packet, an einem Fallschirm befestigt, wird auf den Stift gehängt und verschlossen und der Fallschirm im dazugehörigen Fallschirmschacht verstaut. Der Servo war mittels einer Fernbedienungstaste kontrollierbar und löste so den Abwurf des Paketes aus. Später haben wir den Servo über einen Softwarebefehl auslösbar gemacht. 

\subsection{Kommunikationshardware}
Da die Drohne gemäss unseren Anforderungen eine Verbindung zum Server benötigt, muss geeignete Kommunikationshardware installiert werden. Aus folgenden Gründen haben wir uns für ein Android fähiges Mobiltelefon entschieden:
\begin{itemize}
	\item{Android als Softwareplattform ermöglicht uns die Entwicklung in Java}
	\item{Ein User Interface und Statusanzeige kann auf dem App implementiert werden}
	\item{Es existiert eine passende Bibliothek für die Kommunikation über MAVLink}
	\item{Das Betriebssystem übernimmt den gesammten Kommunikationsstack - sei es im Gebäude mittels WLAN oder im Feld über GSM}
\end{itemize}
Für Verwendungszwecke ohne den Bedarf eines User Interfaces kann man sich allenfalls auch überlegen andere Komponenten zu verwenden. Wir haben 2 Optionen genauer angeschaut und bewertet:
\begin{itemize}
	\item{\textbf{Raspbery PI} \\
	Bereits ab dem leichtgewichtigen Raspberry PI zero sind die nötigen Funktionen vorhanden. Zusätzlich muss hier auf ein GSM Modem zurückgegriffen werden um eine permanente Internetverbindung aufzubauen. Bei Verwendung eines Raspberry PI 3 kann sogar auf ein WLAN Interface zugegriffen werden.
	}
	\item{\textbf{Arduino} \\
	Bei der Arduino Hardware Plattform kann auf einem beliebigen Arduino Board implementiert werden, welches als USB Host Device arbeiten kann. Zusätzlich muss ein GSM Shield 2 verwendet werden um eine GSM Verbindung aufbauen zu können.}
\end{itemize}
Aus unserer Sicht stellen die 2 Embedded Systeme durchaus eine alternative dar. Leider verschwindet aber der Komfort die Drohne zu überwachen mittels dem GUI auf der Onboard App. Beide Alternativen müssen zusätzlich über das Boardstromnetz der Drohne betrieben werden, und benötigen zusätzliche Spannungsregler um die gewünschte Betriebsspannung der Hardware zu gewährleisten. Dies kann noch weiter optimiert werden, wenn die Schaltung genügend Dimensioniert ist, um dem Servo eine stabile Stromversorgung zu gewährleisten, so kann ein externes BEC, welches zur Zeit im Einsatz ist, weg fallen.\\

Abschliessend sollte erwähnt werden, dass die permanente Internetverbindung durchaus eine Anforderung ist, die vieles einschränkt. Kann man sich von dieser Anforderung trennen und mit den Konsequenzen leben, so könnte die Drohne in der Ladezone ausschliesslich mit einem WLAN Netz betrieben werden. Dies wiederum würde einen Raspberry PI 3 sehr attraktiv für dieses Szenario machen.
 
\subsection{Tests}
Um die Anwendungsmöglichkeiten eines solchen Multicopters auszuloten wurden diverse Experimente durchgeführt um die Leistungsfähigkeit und die Einschränkungen zu testen. 

\subsubsection{Akku Laufzeittest}
Um die maximale Akku Laufzeit zu testen wurde die Drohne ohne zusätzliches Gewicht gestartet, etwa 1.5m über dem Boden schweben gelassen und die Zeit gemessen. Dabei versucht die Drohne die Postion zu halten, bei Abweichung wurde aktiv korrigiert. \\

\begin{tabularx}{\textwidth}{|c|c|X|}
\hline
\textbf{Akku} & \textbf{Zuladung} & \textbf{Laufzeit} \\ \hline \hline 
3S & keine & 16min 29s\\ \hline 
2x 4S & 500g & 19min\\ \hline 
\end{tabularx}
\newpage
\subsubsection{Tragfähigkeitstests}
Um das maximale Gewicht zu prüfen, welches auf unsere Drohnen geladen werden kann, wurden Tests mit dem Zielgewicht von ca. 500g durchgeführt. Dies Entspricht dem Gewicht einer PET-Flasche eines beliebigen Getränkeherstellers oder einem leichten Defibrilator. Ausserdem war das Mobiltelefon (ca. 150g) während der Tests auf der Drohne angebracht.  \\

\begin{tabularx}{\textwidth}{|c|c|c|c|X|}
\hline
\textbf{Nutzlast} & \textbf{Akku Typ} & \textbf{Nötige Leistung }& \textbf{Erwartete Flugzeit } & \textbf{Subjektives Flugverhalten }\\
\hline \hline
500g & 3S & ca. 75\%  & n.A. & Ziemlich Träge, mehr Gewicht wäre kritisch\\\hline
500g & 4S & ca. 45\%  & n.A. & Gewicht kaum Spürbar\\
\hline
\end{tabularx}\\

Auch mit 3S Akkus ist es also möglich eine PET-Flasche zu transportieren. Allerdings empfehlen wir für Gewichte über 300 4S-Akkus zu verwenden.\\

Aus den Tragfähigkeitstests schliessen wir, dass auch ein Defibrilator (siehe Aufgabenstellung) mit einer von uns erstellten Drohne transportierbar ist.
\blockquote{I identified the two lightest weight defibrillators on the market in the U.S. at the time of the exploration (March 2013): the Schiller FRED EasyPort (600 grams) and the HeartSine samaritan PAD 300P (1100 grams). The former model is not designed for layperson use, but is far and away the lightest defibrillator available.} 
\cite[p.3]{FleckUAV}
%TODO Zitatdarstellung richtig machen


\section{Ablieferungskonzept}

Um ein möglichst sicheres und einfaches Ablieferungsverfahren zu finden, wurden folgende Optionen in Betracht gezogen.

\subsection{Landung ohne automatischen Abwurf}

Bei diesem Konzept landet die Drohne an der Position des Kunden und dieser kann dann selbst das Paket von der Drohne lösen. Er wird dann mit Hilfe der Onboard-App aufgefordert den Erhalt der Bestellung zu bestätigen. Nach der Bestätigung startet die Drohne einen Countdown, hebt danach ab und fliegt zur Ausgangsposition zurück. Der Kunde kann den Countdown unterbrechen und erneut starten.

Vorteile:
\begin{itemize}
	\item Kunde bestätigt Lieferung
	\item Ware kann keinen Schaden nehmen
	\item Kunde kann entscheiden wann es sicher genug ist, damit die Drohne starten kann.
\end{itemize}


Nachteile:
\begin{itemize}
	\item Drohne kann Personen verletzen, während sie sich in Bodennähe befindet
	\item Aufwendiges Handling auf der Onboard-App
	\item Landung kann schwierig sein je nach Gelände
	\item Fremde Personen haben physischen Zugriff auf die Drohne
\end{itemize}

\subsection{Landung mit automatischem Abwurf}

Dieses System ermöglicht es ohne Fallschirm die Ware abzuwerfen. Dabei Landet die Drohne, löst die Ladung und startet sofort wieder. Es gibt keinerlei Interaktion mit dem Kunden.

Vorteile:
\begin{itemize}
	\item Ware kann keinen Schaden nehmen
\end{itemize}


Nachteile:
\begin{itemize}
	\item Drohne kann Personen verletzen, während sie sich in Bodennähe befindet
	\item Landung kann schwierig sein je nach Gelände
	\item Fremde Personen haben physischen Zugriff auf die Drohne
\end{itemize}


\subsection{Abwurf mit Fallschirm}

Dabei wird ein Fallschirm an der Ware befestigt. Die Drohne löst die Ladung in einer vorgegebenen Höhe und die Ladung schwebt zu Boden.

%TODO Martin hinzufügen Fallschirmberechnungen

Vorteile:
\begin{itemize}
	\item Drohne kann niemanden Verletzen 
	\item Drohne ist ausser Reichweite von Personen
	\item Einfaches Handling auf der Onboard-App
	\item Mechanismus erlaubt auch Landung mit automatischem Abwurf
\end{itemize}


Nachteile:
\begin{itemize}
	\item Ware kann Schaden nehmen
	\item Ware kann Personen verletzen bei Versagen des Fallschirms
	\item Einweg Fallschirme (Kosten und Abfall)
\end{itemize}


\subsection{Entscheidung}

Die Nutzwertanalyse in Abbildung \ref{fig:nutzwertanalyse_abwurf} zeigt klar, dass die letzte Variante die meisten Vorteile bringt. Wichtig ist auch, dass ein Abwurf im gelandeten Zustand weiterhin möglich bleibt, ohne die mechanischen Komponenten zu verändern. Deshalb haben wir uns für einen Abwurf mit dem Fallschirm entschieden.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.9\textwidth] {images/nutzwertanalyse_abwurf.png} 
	\caption{Nutzwertanalyse der verschiedenen Liefervarianten}
	\label{fig:nutzwertanalyse_abwurf}
\end{figure}

\section{Alternative Drohnenarten}

Grundsätzlich können, über das von uns verwendete \Gls{MAVLink} Protokoll, alle Arten von Drohnen angesteuert werden. Beispielsweise bietet die Autopilot-Software \ref{fig:arduScreenshot} 'ArduPilot' Firmware-Varianten für Multicopter, Flugzeuge, Fahrzeuge. \\
\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth] {images/arduScreenshot.jpg}
\caption{Screenshot der verschiedenen Firmwarevarianten.}
\label{fig:arduScreenshot}
\end{figure}

Uplift \ref{fig:uplift} Aero beispielsweise war ein Startup, dass versucht hat, Hilfsgüter mit Hilfe von Drohnen von der Türkei aus nach Syrien zu fliegen. Sie haben für ihre Flugzeuge die selben Flugcontroller wie wir verwendet und mussten lediglich die passende Firmware aufspielen. Dies beweist wie flexibel und vielseitig die von uns eingesetzte Hardware verwendet werden kann.

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth] {images/SyriaUplift.jpg}
\caption{Uplift Team und die Syrien-Drohne Quelle: \protect\url{http://uplift.aero/}}
\label{fig:uplift}
\end{figure}


